<html>
	<head>
		<title>Cibum</title>
		<meta name="author" content="Jacob Mastel">
		<meta name="description" content="A free, open source, recipebook.">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.css">
		<link rel="stylesheet" type="text/css" href="styles.css">
		<script src="jQuery/jquery-2.1.4.js"></script>
		<script src="bootstrap/js/bootstrap.js"></script>
	</head>
	
	<body>
		<nav class="navbar navbar-inverse navbar-fixed-top">
			<div class="container">
				<div class="navbar-header">
				  	<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand">Victus</a>
				</div>
				<div id="navbar" class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
						<li class="active"><a onclick="disp_list()">Home</a></li>
                        <li><a onclick="disp_create()">Create</a></li>
						<!--<li><a href="">About</a></li>-->
						<!--<li><a href="">Contact</a></li>-->
					</ul>
				</div><!--/.nav-collapse -->
		  </div>
		</nav>

		<div class="container container-top">
			<div id="recipe_card_template" class="recipe_card col-lg-4 col-md-6 col-sm-6 col-xs-12 hidden">
				<h4 class="card_title"></h4>
				<p class="card_desc"></p>
			</div>

			<div class="row view view-visible" id="list">
                <div class="content">
                    <div class="input-group">
                        <input type="text" class="form-control" id="exampleInputAmount" placeholder="Search">
                        <div class="input-group-addon">
                            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                        </div>
                    </div> <!-- input group -->
                </div> <!-- content -->
			</div>

			<div class="row view" id="disp_recipe">
				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<h1 id="disp_recipe_name"></h1>
				</div>

                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <h3>Yields: <small id="disp_recipe_yields"></small></h3>
                </div>

                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                    <h3>Notes:</h3>
                    <p id="disp_recipe_notes"></p>
                </div>

                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <h3>Ingredients:</h3>
                    <ul id="disp_recipe_ingredients" class="list-unstyled row"></ul>
				</div>

				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <h3>Directions:</h3>
                    <p id="disp_recipe_directions"></p>
				</div>

                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <h3>Tags:</h3>
                </div>
			</div>

            <div class="row view" id="create_recipe">
                <div class="col-lg-12">
                    <div class="form-group">
                        <label for="create_recipe_id">Name</label>
                        <input type="text" class="form-control" id="create_recipe_id">
                    </div>

                    <div class="form-group">
                        <label for="create_recipe_notes">Notes</label>
                        <input type="text" class="form-control" id="create_recipe_notes">
                    </div>

                    <div class="form-group">
                        <label for="create_recipe_yields">Yield</label>
                        <input type="text" class="form-control" id ="create_recipe_yields">
                    </div>

                    <div class="form-group">
                        <label for="create_recipe_ingredients">Ingredients</label>
                        <ul id="create_recipe_entered_ingredients" class="list-unstyled row"></ul>
                        <div class="input-group">
                            <input type="text" class="form-control" id="create_recipe_ingredients">
                            <div class="input-group-btn"><button class="btn btn-primary">Add</button></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="recipe_create_directions">Directions</label>
                        <textarea class="form-control" id="recipe_create_directions"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="create_recipe_tags">Tags</label>
                        <ul id="create_recipe_entered_tags" class="list-unstyled row"></ul>
                        <div class="input-group">
                            <input type="text" class="form-control" id="create_recipe_tags">
                            <div class="input-group-btn"><button class="btn btn-primary">Add</button></div>
                        </div>
                    </div>
                </div>
            </div>
		</div>
	</body>

	<script>
        var recipes;
		var disp_recipe = function(id) {
            var list    = $("#list");
            var display = $("#disp_recipe");
            var ingr    = display.find("#disp_recipe_ingredients");

            display.find("#disp_recipe_name").text(recipes[id].name);
            display.find("#disp_recipe_directions").text(recipes[id].directions);
            display.find("#disp_recipe_yields").text(recipes[id].yields);

			ingr.empty("");
            for(var i = 0; i < recipes[id].ingredients.length; ++i) {
                var str = "<li class=\"col-xs-12 col-sm-6 col-md-4 col-lg-3\">";
                str += recipes[id].ingredients[i];
                str += "</li>";
                ingr.append(str);
            }

            $(".view-visible").toggleClass("view-visible");
            display.toggleClass("view-visible");

		};

        var disp_create = function() {
            var create = $("#create_recipe");

            $(".view-visible").toggleClass("view-visible");
            create.toggleClass("view-visible");
        };

        var disp_list = function() {
            var list    = $("#list");
            $(".view-visible").toggleClass("view-visible");
            list.toggleClass("view-visible");
        };
		
		$.getJSON("api/", function(data) {
            recipes = data;
			var t = $("#recipe_card_template");
			for(var i = 0; i < data.length; i++) {
                var c = t.clone();
                c.attr("id", "recipe_card_" + i);
                c.find(".card_title").text(data[i].name);
                c.find(".card_desc").text(data[i].notes);
                c.attr("onclick", "disp_recipe(" + i + ")");
                c.removeClass("hidden");
                c.appendTo("#list");
            }
		});
	</script>
</html>
